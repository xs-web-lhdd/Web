<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="main" id="main">
        <div class="menu-box"></div>
        <!-- 子菜单 -->
        <div class="sub-menu hide" id="sub-menu">
            <div class="inner-box">
                <div class="sub-inner-box">
                    <div class="title">手机、配件</div>
                    <div class="sub-row">
                        <span class="bold mr10">手机:</span>
                        <a href="">小米8s</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米黄粉PLus</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米K30黑金纪念版</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米9青春纪念版</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">智能通讯:</span>
                        <a href="">8G运行|64G内存</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">8G运行|128G内存</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">以旧换新|95新二手</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">手机通讯:</span>
                        <a href="">智能WIFI</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">万物互联5G时代</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">行车一卡通</a>
                    </div>
                </div>
            </div>
            <div class="inner-box">
                <div class="sub-inner-box">
                    <div class="title">电脑</div>
                    <div class="sub-row">
                        <span class="bold mr10">电脑:</span>
                        <a href="">笔记本</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">平板</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">一体机</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">台式</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">电脑配件:</span>
                        <a href="">显示器</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">CPU</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">主板</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">硬盘</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">显卡</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">游戏设备:</span>
                        <a href="">游戏机</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">耳机</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">游戏软件</a>
                    </div>
                </div>
            </div>
            <div class="inner-box">
                <div class="sub-inner-box">
                    <div class="title">手机、配件</div>
                    <div class="sub-row">
                        <span class="bold mr10">手机:</span>
                        <a href="">小米8s</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米黄粉PLus</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米K30黑金纪念版</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米9青春纪念版</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">智能通讯:</span>
                        <a href="">8G运行|64G内存</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">8G运行|128G内存</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">以旧换新|95新二手</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">手机通讯:</span>
                        <a href="">智能WIFI</a>WIFI
                        <span class="ml10 mr10">/</span>
                        <a href="">万物互联5G时代</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">行车一卡通</a>
                    </div>
                </div>
            </div>
            <div class="inner-box">
                <div class="sub-inner-box">
                    <div class="title">手机、配件</div>
                    <div class="sub-row">
                        <span class="bold mr10">手机:</span>
                        <a href="">小米8s</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米黄粉PLus</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米K30黑金纪念版</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">小米9青春纪念版</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">智能通讯:</span>
                        <a href="">8G运行|64G内存</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">8G运行|128G内存</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">以旧换新|95新二手</a>
                    </div>
                    <div class="sub-row">
                        <span class="bold mr10">手机通讯:</span>
                        <a href="">智能WIFI</a>WIFI
                        <span class="ml10 mr10">/</span>
                        <a href="">万物互联5G时代</a>
                        <span class="ml10 mr10">/</span>
                        <a href="">行车一卡通</a>
                    </div>
                </div>
            </div>

        </div>
        <!-- 主菜单 -->
        <div class="menu-content" id="menu-content">
            <div class="menu-item">
                <a href="">
                    <span>手机、配件</span>
                    <i class="icon">&#xe665;</i>
                </a>
            </div>
            <div class="menu-item">
                <a href="">
                    <span>电脑</span>
                    <i class="icon">&#xe665;</i>
                </a>
            </div>
            <div class="menu-item">
                <a href="">
                    <span>家用电器</span>
                    <i class="icon">&#xe665;</i>
                </a>
            </div>
            <div class="menu-item">
                <a href="">
                    <span>家具</span>
                    <i class="icon">&#xe665;</i>
                </a>
            </div>
        </div>
        <!-- 焦点图 -->
        <div class="banner" id="banner">
            <a href="">
                <div class="banner-slide slide1 slide-active"></div>
            </a>
            <a href="">
                <div class="banner-slide slide2"></div>
            </a>
            <a href="">
                <div class="banner-slide slide3"></div>
            </a>
            <a href="javascript:void(0)" class="button prev" id="prev"></a>
            <a href="javascript:void(0)" class="button next" id="next"></a>
            <div class="dots" id="dots">
                <span class="active"></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>
    <!-- JS -->
    <script>
        // 声明全局变量
        var index=0,//当前显示图片索引，默认值为0
        timer=null,//定时器
        main=byId("main"),
        prev=byId("prev"),//上一张
        next=byId("next"),//下一张
        pics=byId("banner").getElementsByTagName('div'),
        dots=byId('dots').getElementsByTagName('span'),
        banner=byId('banner'),
        menuContent=byId("menu-content"),
        menuItems=menuContent.getElementsByClassName("menu-item"),
        subMenu=byId("sub-menu"),
        innerBox=subMenu.getElementsByClassName("inner-box"),
        size=pics.length-1;
        // console.log(size);




        //封装getElementById()
        function byId(id){
            return typeof(id)==="string" ? document.getElementById(id):id;
        }

        // 封装通用事件绑定方法
        function addHandler(element,type,handler){
            if(element.addEventListener){
                element.addEventListener(type,handler,true);
            }
            else if(element.attachEvent){
                element.attachEvent("on"+type,handler);
            }
            else{
                element["on"+type]=handler;
            }
        }

//清除定时器,停止自动轮播
function stopAutoPlay(){
    if(timer){
        clearInterval(timer);
    };
} 

//自动轮播
function startAutoPlay(){
    timer = setInterval(() => {
        index++;
        if(index>=size) index=0;
        changeImg();
    }, 3000);
}

// 切换图片     函数封装
function changeImg(){
    // 遍历所有图片，将图片隐藏，将原点上的类清除
    for(var i=0;i < size;i++){
                pics[i].style.display="none";
            }
            pics[index].style.display='block';
// 排他思想
            for(var i=0;i < size;i++){
                dots[i].className="";
            }
            // 将当前圆点高亮显示
            dots[index].className='active';
}
        //点击下一张按钮显示下一张图片
        addHandler(next,"click",function(){
            index++;
            if(index >= size)
            index=0;
            changeImg();
            // console.log(index);
        })

        //点击上一张按钮显示下一张图片
        addHandler(prev,"click",function(){
            index--;
            if(index < 0)
            index=size-1;
            changeImg();
        })

        // 点击圆点索引切换图片
        for(var d = 0;d < size; d++){
            // 若是定义标准属性如 id 时,可以直接用.id    若用不标准的属性(自己定义的)就用setAttribute
            dots[d].setAttribute("tid",d);
            addHandler(dots[d],"click",function(){
                // 中间有 - 的时候不能直接用this.data-id 会报错的,所以要用[]
                // console.log(this["tid"]);
                index = this.getAttribute('tid');
                // console.log(index);
                changeImg();
            })
        }

//鼠标滑过主菜单
for(var m=0,idx,mlen=menuItems.length;m<mlen;m++){
    // 给所有主菜单定义属性,标明它的索引
    menuItems[m].setAttribute("data-index",m);
    addHandler(menuItems[m],"mouseover",function(){
        // 显示子菜单所在的背景
        subMenu.className="sub-menu";
        // 获取当前主菜单的索引  idx就是索引
        idx=this.getAttribute("data-index");
        // 遍历所有的子菜单innerBox,将它们隐藏
        for(var j=0,jlen=innerBox.length;j<jlen;j++){
            // 隐藏所有的子菜单
            innerBox[j].style.display="none";
            // 所有的主菜单恢复原样
            menuItems[j].style.background="none";
        }
        // 找到当前子菜单,令其显示出来
        innerBox[idx].style.display="block";
        menuItems[idx].style.background="rgba(0,0,0,0.1)";
    })
}

// 鼠标离开主菜单banner,隐藏子菜单
addHandler(banner,"mouseout",function(){
    subMenu.className = "sub-menu hide"
})

// 鼠标离开主菜单menuContent,隐藏子菜单
addHandler(menuContent,"mouseout",function(){
    subMenu.className = "sub-menu hide"
})

// 鼠标划入子菜单时,子菜单显示
addHandler(subMenu,"mouseover",function(){
    this.className = "sub-menu";
})

// 鼠标离开子菜单时,子菜单显示
addHandler(subMenu,"mouseout",function(){
    this.className = "sub-menu hide";
})

//鼠标滑入main,停止轮播
addHandler(main,"mouseover",stopAutoPlay); 

// 鼠标离开main,继续轮播
addHandler(main,"mouseout",startAutoPlay);

// 自动开启轮播
startAutoPlay();


    </script>
</body>
<!-- DOM0级与DOM2级的区别
    #DOM0级事件绑定：只能给一个元素的某一个行为绑定一次方法第二次绑定的会把前面的覆盖掉 .onclick=function()
    #DOM2级：可以给某一个元素的同一个行为绑定多个不同的方法 addEventListener()
    #说明：为什么没有一级DOM：DOM级别1于1998年10月1日成为W3C推荐标准。一级DOM标准中并没有定义事件相关的内容所以没有所谓的1级DOM事件模型 
    
    addEventListener()和removeEventListener()
    功能：addEventListener():可以为元素添加多个事件处理程序，触发时会按照添加顺序依次调用
        :removeEventListener():移除事件处理程序。（不能移除匿名添加的函数）-->
</html>